import{c as q,u as E,j as e,a as h,A as f,m as o,S as C,s as i,b as M}from"./supabaseClient.JcG5vpDm.js";import{r as n}from"./index.D0mNDFPE.js";import{u as D,S as P}from"./StarRating.DUbRVut4.js";import"./chunk-XL46KY3Q.yPoBHZKd.js";import"./preload-helper.BlTxHScW.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],L=q("lock",A);function R({burgerId:s}){const[t,b]=n.useState(null),[y,j]=n.useState([]),{user:r}=E(),{open:w,SignInModal:N}=D("/burger"),[c,d]=n.useState(!1),[x,u]=n.useState(null),[v,p]=n.useState(!1),[_,m]=n.useState(!1);n.useEffect(()=>{async function a(){const{data:l}=await i.from("hamburguesas").select("*").eq("id",s).single();b(l);const{data:g}=await i.from("hamburguesa_alergenos").select("alergenos(nombre, icono_url)").eq("hamburguesa_id",s);j(g||[])}a()},[s]),n.useEffect(()=>{if(!r)return;async function a(){const{data:l,error:g}=await i.from("hamburguesas_probadas").select("*").eq("usuario_id",r.id).eq("hamburguesa_id",s).maybeSingle();l&&(d(!0),u(l.puntuacion),m(!0))}a()},[r,s]);async function S(){if(!r||c)return;p(!0);const{error:a}=await i.from("hamburguesas_probadas").insert({usuario_id:r.id,hamburguesa_id:s,puntuacion:null});p(!1),a?console.error(a):(d(!0),m(!0))}async function k(){if(!r||!c)return;const{error:a}=await i.from("hamburguesas_probadas").delete().eq("usuario_id",r.id).eq("hamburguesa_id",s);a?console.error(a):(m(!1),setTimeout(()=>{d(!1),u(null)},300))}return t?e.jsxs("main",{className:"max-w-5xl mx-auto px-1 py-8 space-y-6",children:[t.logo_url&&e.jsx("div",{className:"flex justify-center bg-black rounded-lg p-4 shadow-md mt-6 mb-6",children:e.jsx("img",{src:t.logo_url,alt:`Logo de ${t.restaurante}`,className:"h-16 object-contain"})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsxs("div",{className:"md:basis-1/2 space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold text-center md:text-left",children:t.nombre}),e.jsx("div",{className:"rounded-xl overflow-hidden shadow-lg",children:e.jsx("img",{src:t.imagen_url,alt:t.nombre,className:"w-full h-auto object-cover"})}),e.jsx(h,{children:e.jsx(f,{children:_&&e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"text-center",children:[e.jsx(P,{burgerId:s,usuarioId:r?.id,initialRating:x,onRated:a=>u(a)}),x===null&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"¬øQuieres puntuarla? Solo tienes que hacer clic en las estrellas ‚≠ê"})]})})})]}),e.jsx("div",{className:"md:basis-1/2 space-y-5",children:e.jsxs(o.div,{className:"md:basis-1/2 space-y-5",initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.8,ease:"easeOut"},children:[e.jsx("p",{className:"text-gray-800 leading-relaxed",children:t.descripcion}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-600 mb-2",children:"Contiene:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(a=>e.jsxs("div",{className:"bg-yellow-100 px-2 py-1 rounded-full text-xs flex items-center gap-1 shadow-sm transition-transform duration-200 hover:scale-105 hover:brightness-110",children:[a.alergenos.icono_url&&e.jsx("img",{src:a.alergenos.icono_url,alt:a.alergenos.nombre,className:"w-3.5 h-3.5 object-contain"}),a.alergenos.nombre]},a.alergenos.nombre))})]}),e.jsxs("div",{className:"pt-4",children:[e.jsxs(C,{children:[e.jsxs("div",{className:"p-5 border rounded-lg bg-yellow-50 text-center shadow-md space-y-4",children:[e.jsx("p",{className:"text-lg font-semibold",children:"¬øHas probado esta burger?"}),e.jsxs("p",{className:"flex justify-center items-center gap-1 text-sm text-gray-600",children:[e.jsx(L,{className:"w-4 h-4 text-gray-400"}),"Inicia sesi√≥n para marcarla como probada y darle una puntuaci√≥n"]}),e.jsx("button",{onClick:w,className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transform transition-transform duration-200 hover:scale-105 shadow-lg shadow-yellow-100/40",children:"Iniciar sesi√≥n ahora"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Te llevar√° al login y volver√°s aqu√≠ autom√°ticamente."})]}),e.jsx(h,{children:e.jsx(f,{mode:"wait",children:c?e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:"inline-flex items-center gap-1 bg-green-100 text-green-800 text-sm font-medium px-3 py-1 rounded-full shadow-sm",children:"‚úÖ Ya probada"}),e.jsx("button",{title:"Eliminar esta burger de tu lista de probadas",onClick:k,className:"ml-2 bg-red-100 text-red-600 text-sm px-3 py-1 rounded-full hover:bg-red-200 transition-all",children:"Desmarcar"})]},"desmarcar"):e.jsx(o.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},onClick:S,disabled:v,className:"w-full px-4 py-2 rounded-lg text-white text-center transition-all bg-green-600 hover:bg-green-700",children:"Marcar como probada üçî"},"marcar")})}),e.jsx(N,{})]})]})})]})]}):e.jsx("p",{className:"p-4",children:"Cargando..."})}function H({burgerId:s}){return e.jsx(M,{children:e.jsx(R,{burgerId:s})})}export{H as default};
